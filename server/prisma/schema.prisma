generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(cuid())
  name        String
  email       String   @unique
  password    String
  role        String
  createdAt   DateTime @default(now())
  shifts      Shift[]
  activities  Activity[]
  incidents   Incident[]
}

model Shift {
  id           String   @id @default(cuid())
  user         User     @relation(fields: [userId], references: [id])
  userId       String
  startAt      DateTime
  endAt        DateTime?
  totalSeconds Int?
  activities   Activity[]
  incidents    Incident[]
}

model Activity {
  id        String   @id @default(cuid())
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  shift     Shift?   @relation(fields: [shiftId], references: [id])
  shiftId   String?
  timestamp DateTime @default(now())
  type      String
  payload   Json
}

model Incident {
  id        String   @id @default(cuid())
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  shift     Shift?   @relation(fields: [shiftId], references: [id])
  shiftId   String?
  timestamp DateTime @default(now())
  reason    String
  details   Json
}

model Setting {
  id                 String   @id @default(cuid())
  blacklistedDomains String[] @default([])
  heartbeatInterval  Int      @default(15)
  idleThreshold      Int      @default(120)
  createdAt          DateTime @default(now())
}
